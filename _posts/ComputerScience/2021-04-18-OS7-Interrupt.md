---
categories: 
   - ComputerScience
tags:
   - Fastcampus
   - OS
---

# 인터럽트
---

### 인터럽트
- 마이크로프로세서(CPU)가 프로그램을 실행하고 있을 때, 입출력 하드웨어 등의 장치에 예외상황이 발생하여 처리가 필요할 경우에 **마이크로프로세서에게 알려 처리할 수 있도록 하는 것**을 말한다.

<br>

### 인터럽트가 필요한 이유
 - 선점형 스케줄러 구현
   + 스케쥴러가 running 중인 프로세스를 중단시키고, 다른 프로세스로 교체하기 위해 현재 프로세스 실행을 중단시킴.
   -> 스케쥴러 코드가 실행이 되서 현 프로세스 실행을 중지시켜야 함.
 - IO Device 와의 커뮤니케이션
   + 저장매체에서 데이터 처리 완료시, 프로세스를 깨워야함(block state -> ready state)
- 예외 상황 핸들링
   + CPU가 프로그램을 실행하고 있을때, 입출력 하드웨어 등의 장치나 또는 예외상황이 발생할 경우 CPU가 해당 처리를 할 수 있도록 CPU에 알려줘야함.

<br>

### 📍인터럽트는 일종의 이벤트로 불림<br>이벤트에 맞게 운영체제가 처리

<br>

### 주요 인터럽트
1. 계산하는 코드에서 0으로 나누는 코드 실행시
2. 타이머 인터럽트 - 특정한 시간이 되면 인터럽트가 발생(선점형 스케쥴러를 위해 필요)
3. 입출력 입터럽트 - 키보드/마우스의 입력 등.

<br>

### 인터럽트 종류
- 내부 인터럽트(소프트웨어 인터럽트)
   + 주로 프로그램 내부에서 잘못된 명령 또는 잘못된 데이터 사용시 발생
      - 0으로 나눴을때
      - 사용자 모드에서 허용되지 않은 명령 또는 공간 접근시
      - 계산 결과가  Overflow/Underflow 날 때
- 외부 인터럽트(하드웨어 인터럽트)
   + 주로 하드웨어에서 발생되는 이벤트
      - 전원 이상
      - 기계 문제
      - 키보드 등 IO 관련 이벤트
      - Timer 이벤트

<br>

### 시스템 콜 인터럽트
- 시스템콜 실행을 위해서는 강제로 코드에 인터럽트 명령을 넣어 CPU에게 실행시켜야 한다.
- 시스템 콜 실제 코드
   + eax 레지스터에 시스템 콜 번호를 넣고,
   + ebx 레지스터에는 시스템 콜에 해당하는 인자값을 넣고,
   + 소프트웨어 인터럽트 명령을 호출하면서 **0x80**값을 넘겨줌

<br>

### 인터럽트와 IDT
- 인터럽트는 미리 정의되어 각각 번호와 실행코드를 가리키는 주소가 기록되어 있음.
- 컴퓨터 부팅시 운영체제가 **IDT(Interrupt Descriptor Table)**에 기록
- 리눅스의 예
   + 0~31 : 예외상황 인터럽트
   + 32~47 : 하드웨어 이넡럽트
   + 128 : 시스템 콜

> 위 **시스템 콜 인터럽트**를 다시 보면,<br>1. 인터럽트 발생하여 IDT 확인.<br>2. 시스템콜인터럽트는 **0x80**값 넘겨줌.(0x80은 십진수로 128)<br>3. IDT에 0x80 -> system_call() 라고 되어있고, eax에서 받은 시스템콜을 실행.

<br>

### 인터럽트와 프로세스
1. 프로세스 실행 중 인터럽트 발생
2. 현 프로세스 실행 중단
3. 인터럽트 처리 함수 실행(운영체제)
4. 현 프로세스 재실행.

<img src="/assets/images/computerscience/interproc.png" width="70%" height="" title="interproc" alt="interproc"/>

<br>

### 인터럽트와 프로세스
->선점형 스케쥴러 구현 예
- 수시로 타이머 인터럽트 발생
   + 운영체제가 타이머 인터럽트 발생 횟수를 기억해서 예를 들어 5번 타이머 인터럽트가 발생하면 현재 프로세스를 다른 프로세스로 바꿔준다. 등

<img src="/assets/images/computerscience/intersche.png" width="70%" height="" title="intersche" alt="intersche"/>

<br>

### 📌정리  
#### 위의 모든 과정을 운영체제가 처리한다.(인터럽트 발생 부터 처리까지 등등)
#### 그래서 운영체제의 한 챕터로 인터럽트 라는걸 배우는것이다!!

<br>

>참고/출처:<br>- 패스트캠퍼스 운영체제 강의(Dave Lee 강사님)